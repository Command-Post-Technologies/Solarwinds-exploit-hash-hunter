clear
<#>
Created by Command Post Technologies
</#>
#sha 1-7 are from fireeye github
#diff is the number of times the hash is matched
$diff = 0
$sha1 = "1b476f58ca366b54f34d714ffce3fd73cc30db1a"
$sha2 = "47d92d49e6f7f296260da1af355f941eb25360c4"
$sha3 = "76640508b1e7759e548771a5359eaed353bf1eec"
$sha4 = "b485953ed77caefe81bff0d9b349a33c5cea4cde"
$sha5 = "2f1a5a7411d015d01aaee4535835400191645023"
$sha6 = "d130bd75645c2433f88ac03e73395fba172ef676"
$sha7 = "cfc57d48effb5bbd4e0a6f80e6041d9faf7d7ab4"
$sha8 = "5e643654179e8b4cfe1d3c1906a90a4c8d611cea"
$sha9 = "ebe711516d0f5cd8126f4d53e375c90b7b95e8f2"
$sha10 = "c2c30b3a287d82f88753c85cfb11ec9eb1466bad"
$sha11 = "75af292f34789a1c782ea36c7127bf6106f595e8"


#user input
$drive = Read-Host -Prompt 'what drive would you like to scan? eg "C:\"'
$exportlocation = Read-Host -Prompt 'where would you like the results saved? eg"C:\Temp\results.csv"'

Write-Host Saving all generated hashes to $exportlocation this can take a long time...
$filestocheck = Get-ChildItem -Path $drive -Recurse -File -ErrorAction SilentlyContinue | Get-FileHash -Algorithm SHA1 -ErrorAction SilentlyContinue 
$filestocheck | Export-Csv -Path $exportlocation -Append
$table = Import-Csv -Path $exportlocation

Write-Host hashes created checking against known hashes published on 12/16/2020
foreach($line in $table.Hash){if($line -match $regex){
if ($sha1 -eq $line){write-host match was found please check $exportlocation ...checking remaining hashes}
elseif ($sha2 -eq $line){$diff+=1 ; write-host match was found please check $exportlocation ...checking remaining hashes}
elseif ($sha3 -eq $line){$diff+=1 ; write-host match was found please check $exportlocation ...checking remaining hashes}
elseif ($sha4 -eq $line){$diff+=1 ; write-host match was found please check $exportlocation ...checking remaining hashes}
elseif ($sha5 -eq $line){$diff+=1 ; write-host match was found please check $exportlocation ...checking remaining hashes}
elseif ($sha6 -eq $line){$diff+=1 ; write-host match was found please check $exportlocation ...checking remaining hashes}
elseif ($sha7 -eq $line){$diff+=1 ; write-host match was found please check $exportlocation ...checking remaining hashes}
elseif ($sha8 -eq $line){$diff+=1 ; write-host match was found please check $exportlocation ...checking remaining hashes}
elseif ($sha9 -eq $line){$diff+=1 ; write-host match was found please check $exportlocation ...checking remaining hashes}
elseif ($sha10 -eq $line){$diff+=1 ; write-host match was found please check $exportlocation ...checking remaining hashes}
elseif ($sha11 -eq $line){$diff+=1 ; write-host match was found please check $exportlocation ...checking remaining hashes}
}}

Write-Host check is complete
Write-Host number of hashes matched $diff
