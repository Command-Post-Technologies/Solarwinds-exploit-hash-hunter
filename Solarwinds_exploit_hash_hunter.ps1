clear
<#>
Created by Command Post Technologies
</#>
#sha 1-7 are from fireeye github
#diff is the number of times the hash is matched
$diff = 0
$sha1 = "1b476f58ca366b54f34d714ffce3fd73cc30db1a"
$sha2 = "47d92d49e6f7f296260da1af355f941eb25360c4" 
$sha3 = "2f1a5a7411d015d01aaee4535835400191645023"
$sha4 = "d130bd75645c2433f88ac03e73395fba172ef676"
$sha5 = "76640508b1e7759e548771a5359eaed353bf1eec"
$sha6 = "c2c30b3a287d82f88753c85cfb11ec9eb1466bad"
$sha7 = "75af292f34789a1c782ea36c7127bf6106f595e8" 

#sha 8 is a test
#$sha8 = "92B2A402186BF34361707A8B3959FC1F7515C1D1"

#user input
$drive = Read-Host -Prompt 'what drive would you like to scan? eg "C:\"'
$exportlocation = Read-Host -Prompt 'where would you like the results saved? eg"C:\Temp\results.csv"'

Write-Host Saving all generated hashes to $exportlocation this can take a long time...
$filestocheck = Get-ChildItem -Path $drive -Recurse -File -ErrorAction SilentlyContinue | Get-FileHash -Algorithm SHA1 -ErrorAction SilentlyContinue 
$filestocheck | Export-Csv -Path $exportlocation -Append
$table = Import-Csv -Path $exportlocation

Write-Host hashes created checking against known hashes published on 12/16/2020
foreach($line in $table.Hash){if($line -match $regex){
if ($sha1 -eq $line){write-host match was found please check $exportlocation ...checking remaining hashes}
elseif ($sha2 -eq $line){$diff+=1 ; write-host match was found please check $exportlocation ...checking remaining hashes}
elseif ($sha3 -eq $line){$diff+=1 ; write-host match was found please check $exportlocation ...checking remaining hashes}
elseif ($sha4 -eq $line){$diff+=1 ; write-host match was found please check $exportlocation ...checking remaining hashes}
elseif ($sha5 -eq $line){$diff+=1 ; write-host match was found please check $exportlocation ...checking remaining hashes}
elseif ($sha6 -eq $line){$diff+=1 ; write-host match was found please check $exportlocation ...checking remaining hashes}
elseif ($sha7 -eq $line){$diff+=1 ; write-host match was found please check $exportlocation ...checking remaining hashes}
#elseif ($sha8 -eq $line){$diff+=1 ; write-host match was found please check $exportlocation ...checking remaining hashes}
}}

Write-Host check is complete
Write-Host number of hashes matched $diff